<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

  
<mapper namespace="web.dao.face.CreditDao">

	<select id="selectAllCreditList" resultType="web.dto.Credit" parameterType="web.dto.Credit">
		select 
			deal_no, 
			user_no, 
			(SELECT to_date(to_char(deal_date,'yy.mm.dd'),'yy.mm.dd') from dual) deal_date, 
			deal_category, 
			amount 
		from credit
		where user_no = #{userNo}
		order by deal_date desc
	</select>
	
	<select id="selectUserGrade" resultType="String" parameterType="web.dto.Users">
		select user_grade from users 
		where user_no = #{userNo}
	</select>

	<select id="selectCreditAcc" resultType="int" parameterType="web.dto.Credit">
		SELECT 
	    (
	        SELECT nvl(SUM(AMOUNT),0) FROM CREDIT
	        WHERE DEAL_CATEGORY IN (1, 3)
	        AND USER_NO=#{userNo}
	    )
	    - 
	    (
	        SELECT nvl(SUM(AMOUNT),0) FROM CREDIT
	        WHERE DEAL_CATEGORY IN (2, 4)
	        AND USER_NO=#{userNo}
	    ) AMOUNT
		FROM DUAL
	</select>
</mapper>